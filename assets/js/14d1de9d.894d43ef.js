"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9779],{7111:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"examples/basic/validation","title":"JSON\u6570\u636e\u9a8c\u8bc1\u793a\u4f8b","description":"\u672c\u793a\u4f8b\u5c55\u793a\u5982\u4f55\u4f7f\u7528JsonSage\u8fdb\u884cJSON\u6570\u636e\u9a8c\u8bc1\u3002","source":"@site/docs/examples/basic/validation.md","sourceDirName":"examples/basic","slug":"/examples/basic/validation","permalink":"/jsonsage/examples/basic/validation","draft":false,"unlisted":false,"editUrl":"https://github.com/hongping1963-source/jsonsage/tree/main/website/docs/examples/basic/validation.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"JSON\u6587\u4ef6\u76d1\u63a7\u793a\u4f8b","permalink":"/jsonsage/examples/basic/file-monitoring"},"next":{"title":"JSON\u6570\u636e\u8f6c\u6362\u793a\u4f8b","permalink":"/jsonsage/examples/basic/transformation"}}');var a=s(74848),t=s(28453);const i={},o="JSON\u6570\u636e\u9a8c\u8bc1\u793a\u4f8b",l={},c=[{value:"\u57fa\u7840\u9a8c\u8bc1",id:"\u57fa\u7840\u9a8c\u8bc1",level:2},{value:"\u7b80\u5355\u7c7b\u578b\u9a8c\u8bc1",id:"\u7b80\u5355\u7c7b\u578b\u9a8c\u8bc1",level:3},{value:"\u4f7f\u7528 Schema \u9a8c\u8bc1",id:"\u4f7f\u7528-schema-\u9a8c\u8bc1",level:3},{value:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u89c4\u5219",id:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u89c4\u5219",level:3},{value:"\u6570\u7ec4\u9a8c\u8bc1",id:"\u6570\u7ec4\u9a8c\u8bc1",level:3},{value:"\u5d4c\u5957\u5bf9\u8c61\u9a8c\u8bc1",id:"\u5d4c\u5957\u5bf9\u8c61\u9a8c\u8bc1",level:3},{value:"\u9519\u8bef\u5904\u7406",id:"\u9519\u8bef\u5904\u7406",level:3},{value:"\u4f7f\u7528 AI \u8f85\u52a9\u9a8c\u8bc1",id:"\u4f7f\u7528-ai-\u8f85\u52a9\u9a8c\u8bc1",level:3},{value:"\u9ad8\u7ea7\u9a8c\u8bc1",id:"\u9ad8\u7ea7\u9a8c\u8bc1",level:2},{value:"\u81ea\u5b9a\u4e49\u683c\u5f0f",id:"\u81ea\u5b9a\u4e49\u683c\u5f0f",level:3},{value:"\u6761\u4ef6\u9a8c\u8bc1",id:"\u6761\u4ef6\u9a8c\u8bc1",level:3},{value:"\u6279\u91cf\u9a8c\u8bc1",id:"\u6279\u91cf\u9a8c\u8bc1",level:2},{value:"\u5b9e\u65f6\u9a8c\u8bc1",id:"\u5b9e\u65f6\u9a8c\u8bc1",level:2},{value:"\u5b8c\u6574\u793a\u4f8b",id:"\u5b8c\u6574\u793a\u4f8b",level:2},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"json\u6570\u636e\u9a8c\u8bc1\u793a\u4f8b",children:"JSON\u6570\u636e\u9a8c\u8bc1\u793a\u4f8b"})}),"\n",(0,a.jsx)(e.p,{children:"\u672c\u793a\u4f8b\u5c55\u793a\u5982\u4f55\u4f7f\u7528JsonSage\u8fdb\u884cJSON\u6570\u636e\u9a8c\u8bc1\u3002"}),"\n",(0,a.jsx)(e.h2,{id:"\u57fa\u7840\u9a8c\u8bc1",children:"\u57fa\u7840\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.h3,{id:"\u7b80\u5355\u7c7b\u578b\u9a8c\u8bc1",children:"\u7b80\u5355\u7c7b\u578b\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.p,{children:"\u6700\u57fa\u672c\u7684\u9a8c\u8bc1\u662f\u68c0\u67e5\u6570\u636e\u7c7b\u578b\u548c\u5fc5\u586b\u5b57\u6bb5\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'import { JsonSage } from \'jsonsage\';\n\nconst sage = new JsonSage();\n\n// \u8981\u9a8c\u8bc1\u7684\u6570\u636e\nconst data = {\n  name: "John Doe",\n  age: 30,\n  email: "john@example.com",\n  isActive: true\n};\n\n// \u9a8c\u8bc1\u6570\u636e\nconst result = await sage.validate(data);\n\nif (result.isValid) {\n  console.log("\u6570\u636e\u9a8c\u8bc1\u901a\u8fc7");\n} else {\n  console.error("\u9a8c\u8bc1\u5931\u8d25:", result.errors);\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u4f7f\u7528-schema-\u9a8c\u8bc1",children:"\u4f7f\u7528 Schema \u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.p,{children:"\u4f7f\u7528 JSON Schema \u8fdb\u884c\u66f4\u590d\u6742\u7684\u9a8c\u8bc1\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'const userSchema = {\n  type: "object",\n  properties: {\n    name: {\n      type: "string",\n      minLength: 2,\n      maxLength: 50\n    },\n    age: {\n      type: "number",\n      minimum: 0,\n      maximum: 120\n    },\n    email: {\n      type: "string",\n      format: "email"\n    },\n    isActive: {\n      type: "boolean"\n    }\n  },\n  required: ["name", "email"]\n};\n\nconst result = await sage.validate(data, userSchema);\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u89c4\u5219",children:"\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u89c4\u5219"}),"\n",(0,a.jsx)(e.p,{children:"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u9a8c\u8bc1\u89c4\u5219\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'const customSchema = {\n  type: "object",\n  properties: {\n    password: {\n      type: "string",\n      minLength: 8,\n      pattern: "^(?=.*[A-Za-z])(?=.*\\\\d)[A-Za-z\\\\d]{8,}$"\n    },\n    confirmPassword: {\n      type: "string"\n    }\n  },\n  required: ["password", "confirmPassword"],\n  custom: {\n    passwordMatch: (data) => {\n      return data.password === data.confirmPassword;\n    }\n  }\n};\n\nconst userData = {\n  password: "Password123",\n  confirmPassword: "Password123"\n};\n\nconst result = await sage.validate(userData, customSchema);\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u6570\u7ec4\u9a8c\u8bc1",children:"\u6570\u7ec4\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.p,{children:"\u9a8c\u8bc1\u6570\u7ec4\u7c7b\u578b\u7684\u6570\u636e\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'const arraySchema = {\n  type: "array",\n  items: {\n    type: "object",\n    properties: {\n      id: { type: "number" },\n      name: { type: "string" }\n    },\n    required: ["id", "name"]\n  },\n  minItems: 1,\n  maxItems: 10\n};\n\nconst users = [\n  { id: 1, name: "John" },\n  { id: 2, name: "Jane" }\n];\n\nconst result = await sage.validate(users, arraySchema);\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u5d4c\u5957\u5bf9\u8c61\u9a8c\u8bc1",children:"\u5d4c\u5957\u5bf9\u8c61\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.p,{children:"\u9a8c\u8bc1\u590d\u6742\u7684\u5d4c\u5957\u5bf9\u8c61\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'const nestedSchema = {\n  type: "object",\n  properties: {\n    user: {\n      type: "object",\n      properties: {\n        name: { type: "string" },\n        address: {\n          type: "object",\n          properties: {\n            street: { type: "string" },\n            city: { type: "string" },\n            country: { type: "string" }\n          },\n          required: ["street", "city"]\n        }\n      },\n      required: ["name", "address"]\n    }\n  }\n};\n\nconst nestedData = {\n  user: {\n    name: "John Doe",\n    address: {\n      street: "123 Main St",\n      city: "New York",\n      country: "USA"\n    }\n  }\n};\n\nconst result = await sage.validate(nestedData, nestedSchema);\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u9519\u8bef\u5904\u7406",children:"\u9519\u8bef\u5904\u7406"}),"\n",(0,a.jsx)(e.p,{children:"\u5904\u7406\u9a8c\u8bc1\u9519\u8bef\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'try {\n  const result = await sage.validate(data, schema);\n  \n  if (!result.isValid) {\n    result.errors.forEach(error => {\n      console.error(`\u9519\u8bef\u8def\u5f84: ${error.path}`);\n      console.error(`\u9519\u8bef\u6d88\u606f: ${error.message}`);\n      console.error(`\u9519\u8bef\u7c7b\u578b: ${error.type}`);\n    });\n  }\n} catch (error) {\n  console.error("\u9a8c\u8bc1\u8fc7\u7a0b\u51fa\u9519:", error);\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u4f7f\u7528-ai-\u8f85\u52a9\u9a8c\u8bc1",children:"\u4f7f\u7528 AI \u8f85\u52a9\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.p,{children:"JsonSage \u7684 AI \u529f\u80fd\u53ef\u4ee5\u5e2e\u52a9\u4f60\u8bc6\u522b\u6f5c\u5728\u7684\u6570\u636e\u95ee\u9898\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"// \u542f\u7528 AI \u9a8c\u8bc1\nconst sage = new JsonSage({\n  aiModel: 'deepseek'\n});\n\n// AI \u4f1a\u5206\u6790\u6570\u636e\u5e76\u63d0\u4f9b\u5efa\u8bae\nconst result = await sage.validate(data, {\n  enableAI: true,\n  aiSuggestions: true\n});\n\n// \u67e5\u770b AI \u5efa\u8bae\nif (result.suggestions) {\n  console.log(\"AI \u5efa\u8bae:\", result.suggestions);\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u9ad8\u7ea7\u9a8c\u8bc1",children:"\u9ad8\u7ea7\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.h3,{id:"\u81ea\u5b9a\u4e49\u683c\u5f0f",children:"\u81ea\u5b9a\u4e49\u683c\u5f0f"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"sage.addFormat('chinese-phone', {\n  validate: (phone) => /^1[3-9]\\d{9}$/.test(phone),\n  errorMessage: '\u5fc5\u987b\u662f\u6709\u6548\u7684\u4e2d\u56fd\u624b\u673a\u53f7\u7801'\n});\n\nconst schema = {\n  type: 'object',\n  properties: {\n    phone: { type: 'string', format: 'chinese-phone' }\n  }\n};\n"})}),"\n",(0,a.jsx)(e.h3,{id:"\u6761\u4ef6\u9a8c\u8bc1",children:"\u6761\u4ef6\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"const schema = {\n  type: 'object',\n  properties: {\n    type: { type: 'string', enum: ['personal', 'business'] },\n    taxId: { type: 'string' }\n  },\n  required: ['type'],\n  if: {\n    properties: { type: { const: 'business' } }\n  },\n  then: {\n    required: ['taxId']\n  }\n};\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u6279\u91cf\u9a8c\u8bc1",children:"\u6279\u91cf\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"async function validateMultipleFiles() {\n  const sage = new JsonSage();\n  \n  const results = await sage.validateBatch({\n    './users/*.json': userSchema,\n    './products/*.json': productSchema,\n    './orders/*.json': orderSchema\n  });\n\n  for (const [file, result] of Object.entries(results)) {\n    if (!result.valid) {\n      console.error(`\u6587\u4ef6 ${file} \u9a8c\u8bc1\u5931\u8d25:`, result.errors);\n    }\n  }\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u5b9e\u65f6\u9a8c\u8bc1",children:"\u5b9e\u65f6\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"const sage = new JsonSage({\n  watchPath: './data',\n  validateOnChange: true,\n  schemas: {\n    'users/*.json': userSchema,\n    'products/*.json': productSchema\n  }\n});\n\nsage.on('validationError', (error) => {\n  console.error('\u9a8c\u8bc1\u9519\u8bef:', {\n    file: error.file,\n    errors: error.errors\n  });\n});\n\nsage.start();\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u5b8c\u6574\u793a\u4f8b",children:"\u5b8c\u6574\u793a\u4f8b"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"import { JsonSage } from '@zhanghongping/json-sage-workflow';\nimport * as fs from 'fs';\n\nasync function setupValidation() {\n  // \u521b\u5efa\u9a8c\u8bc1\u5668\u5b9e\u4f8b\n  const sage = new JsonSage({\n    watchPath: './data',\n    validateOnChange: true\n  });\n\n  // \u6dfb\u52a0\u81ea\u5b9a\u4e49\u683c\u5f0f\n  sage.addFormat('chinese-phone', {\n    validate: (phone) => /^1[3-9]\\d{9}$/.test(phone),\n    errorMessage: '\u5fc5\u987b\u662f\u6709\u6548\u7684\u4e2d\u56fd\u624b\u673a\u53f7\u7801'\n  });\n\n  // \u5b9a\u4e49\u7528\u6237\u6a21\u5f0f\n  const userSchema = {\n    type: 'object',\n    properties: {\n      id: { type: 'string', pattern: '^USER_\\\\d+$' },\n      name: { type: 'string', minLength: 2 },\n      age: { type: 'number', minimum: 0 },\n      email: { type: 'string', format: 'email' },\n      phone: { type: 'string', format: 'chinese-phone' },\n      address: {\n        type: 'object',\n        properties: {\n          street: { type: 'string' },\n          city: { type: 'string' },\n          country: { type: 'string' }\n        },\n        required: ['city', 'country']\n      }\n    },\n    required: ['id', 'name', 'email']\n  };\n\n  // \u914d\u7f6e\u9a8c\u8bc1\u89c4\u5219\n  sage.setSchemas({\n    'users/*.json': userSchema\n  });\n\n  // \u76d1\u542c\u9a8c\u8bc1\u4e8b\u4ef6\n  sage.on('validationError', (error) => {\n    console.error(`\u6587\u4ef6 ${error.file} \u9a8c\u8bc1\u5931\u8d25:`, error.errors);\n    // \u53d1\u9001\u901a\u77e5\u6216\u8bb0\u5f55\u65e5\u5fd7\n    notifyValidationError(error);\n  });\n\n  sage.on('validationSuccess', (file) => {\n    console.log(`\u6587\u4ef6 ${file} \u9a8c\u8bc1\u901a\u8fc7`);\n  });\n\n  // \u542f\u52a8\u76d1\u63a7\u548c\u9a8c\u8bc1\n  await sage.start();\n\n  return sage;\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nconst userData = {\n  id: 'USER_001',\n  name: '\u5f20\u4e09',\n  age: 30,\n  email: 'zhangsan@example.com',\n  phone: '13912345678',\n  address: {\n    street: '\u4e2d\u5173\u6751\u5927\u88571\u53f7',\n    city: '\u5317\u4eac',\n    country: '\u4e2d\u56fd'\n  }\n};\n\n// \u9a8c\u8bc1\u5355\u4e2a\u6570\u636e\nconst sage = new JsonSage();\nconst result = await sage.validateData(userData, userSchema);\n\nif (result.valid) {\n  console.log('\u6570\u636e\u9a8c\u8bc1\u901a\u8fc7');\n  await fs.promises.writeFile(\n    './data/users/USER_001.json',\n    JSON.stringify(userData, null, 2)\n  );\n} else {\n  console.error('\u6570\u636e\u9a8c\u8bc1\u5931\u8d25:', result.errors);\n}\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u6a21\u5f0f\u590d\u7528"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u5c06\u5e38\u7528\u7684\u6a21\u5f0f\u5b9a\u4e49\u4e3a\u5e38\u91cf"}),"\n",(0,a.jsx)(e.li,{children:"\u4f7f\u7528\u6a21\u5f0f\u7ec4\u5408\u521b\u5efa\u590d\u6742\u9a8c\u8bc1\u89c4\u5219"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u9519\u8bef\u5904\u7406"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u4e3a\u6bcf\u79cd\u9519\u8bef\u7c7b\u578b\u5b9a\u4e49\u6e05\u6670\u7684\u9519\u8bef\u6d88\u606f"}),"\n",(0,a.jsx)(e.li,{children:"\u5b9e\u73b0\u9519\u8bef\u6062\u590d\u673a\u5236"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u6027\u80fd\u4f18\u5316"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u4f7f\u7528\u7f13\u5b58\u907f\u514d\u91cd\u590d\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.li,{children:"\u5b9e\u73b0\u589e\u91cf\u9a8c\u8bc1"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u53ef\u7ef4\u62a4\u6027"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u5c06\u6a21\u5f0f\u5b9a\u4e49\u653e\u5728\u5355\u72ec\u7684\u6587\u4ef6\u4e2d"}),"\n",(0,a.jsx)(e.li,{children:"\u4f7f\u7528\u6ce8\u91ca\u8bf4\u660e\u9a8c\u8bc1\u89c4\u5219\u7684\u7528\u9014"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(e.li,{children:["\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u76d1\u63a7\u548c\u65e5\u5fd7"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u8bb0\u5f55\u9a8c\u8bc1\u9519\u8bef\u548c\u6027\u80fd\u6307\u6807"}),"\n",(0,a.jsx)(e.li,{children:"\u8bbe\u7f6e\u544a\u8b66\u9608\u503c"}),"\n"]}),"\n"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},28453:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>o});var r=s(96540);const a={},t=r.createContext(a);function i(n){const e=r.useContext(t);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),r.createElement(t.Provider,{value:e},n.children)}}}]);